# CryptoTax

**CryptoTax** ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è TON –∫–æ—à–µ–ª—å–∫–∞–º–∏ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞ –Ω–∞–ª–æ–≥–æ–≤ –Ω–∞ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏. –°–µ—Ä–≤–∏—Å –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –±–µ–∑–æ–ø–∞—Å–Ω–æ –ø–æ–¥–∫–ª—é—á–∞—Ç—å —Å–≤–æ–∏ TON –∫–æ—à–µ–ª—å–∫–∏ —á–µ—Ä–µ–∑ TON Connect, –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π, –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –±–∞–ª–∞–Ω—Å –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å –Ω–∞–ª–æ–≥–æ–≤—ã–µ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ö–æ–¥—è—â–∏—Ö –ø–µ—Ä–µ–≤–æ–¥–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç–æ–¥–∞ FIFO.

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–æ –Ω–∞ Django REST Framework –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–µ–º–∏—É–º –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤ —Å—Ç–∏–ª–µ –∫—Ä–∏–ø—Ç–æ–∫–æ—à–µ–ª—å–∫–æ–≤. –í—Å–µ –¥–∞–Ω–Ω—ã–µ –æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è —Å –±–ª–æ–∫—á–µ–π–Ω–æ–º TON –∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∏ —Ä–∞—Å—á–µ—Ç–æ–≤. –°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–æ–º–µ—Å—è—á–Ω—É—é –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å –∏ –¥–µ—Ç–∞–ª—å–Ω—É—é —Ä–∞–∑–±–∏–≤–∫—É –Ω–∞–ª–æ–≥–æ–≤ –ø–æ –ø–µ—Ä–∏–æ–¥–∞–º.

## Features

- üîê **JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –≤—Ö–æ–¥–∞ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º —Ç–æ–∫–µ–Ω–æ–≤
- üíº **TON Connect –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–æ–≤ (Tonkeeper –∏ –¥—Ä—É–≥–∏–µ)
- üí∞ **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–æ–º** ‚Äî –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –±–∞–ª–∞–Ω—Å–∞ –∫–æ—à–µ–ª—å–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- üìä **–ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π** ‚Äî –ø–æ–ª–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –±–ª–æ–∫—á–µ–π–Ω–æ–º TON, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
- üìà **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç –Ω–∞–ª–æ–≥–æ–≤** ‚Äî –º–µ—Ç–æ–¥ FIFO –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –ø—Ä–∏–±—ã–ª–∏ –∏ –Ω–∞–ª–æ–≥–æ–≤—ã—Ö –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤
- üìÖ **–ü–æ–º–µ—Å—è—á–Ω–∞—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å** ‚Äî –¥–µ—Ç–∞–ª—å–Ω–∞—è —Ä–∞–∑–±–∏–≤–∫–∞ –Ω–∞–ª–æ–≥–æ–≤ –ø–æ –º–µ—Å—è—Ü–∞–º —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –≤—ã–±–æ—Ä–∞ –ø–µ—Ä–∏–æ–¥–∞
- üöÄ **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö** ‚Äî –±—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ –ë–î —Å —Ñ–æ–Ω–æ–≤—ã–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º –∏–∑ –±–ª–æ–∫—á–µ–π–Ω–∞
- üé® **–ü—Ä–µ–º–∏—É–º UI** ‚Äî –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –¥–∏–∑–∞–π–Ω –≤ —Å—Ç–∏–ª–µ –∫—Ä–∏–ø—Ç–æ–∫–æ—à–µ–ª—å–∫–æ–≤, –∞–¥–∞–ø—Ç–∏–≤–Ω–∞—è –≤–µ—Ä—Å—Ç–∫–∞
- üîÑ **SPA –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** ‚Äî Single Page Application —Å hash-based —Ä–æ—É—Ç–∏–Ω–≥–æ–º

## Tech Stack

### Backend
- **Python 3.10+** ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è
- **Django 5.2.6** ‚Äî –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **Django REST Framework 3.16.1** ‚Äî REST API
- **SQLite** ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–ª–µ–≥–∫–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ PostgreSQL)
- **PyJWT 2.10.1** ‚Äî JWT —Ç–æ–∫–µ–Ω—ã –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- **pytoniq-core 0.1.45** ‚Äî —Ä–∞–±–æ—Ç–∞ —Å –±–ª–æ–∫—á–µ–π–Ω–æ–º TON
- **pytonconnect 0.3.2** ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å TON Connect
- **aiohttp 3.13.2** ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ HTTP –∑–∞–ø—Ä–æ—Å—ã
- **requests 2.32.5** ‚Äî HTTP –∫–ª–∏–µ–Ω—Ç –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö API
- **redis 5.2.0** ‚Äî –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### Frontend
- **HTML5/CSS3** ‚Äî —Ä–∞–∑–º–µ—Ç–∫–∞ –∏ —Å—Ç–∏–ª–∏–∑–∞—Ü–∏—è
- **JavaScript (Vanilla)** ‚Äî SPA —Ä–æ—É—Ç–∏–Ω–≥, AJAX –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ
- **TON Connect UI** ‚Äî –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫–æ—à–µ–ª—å–∫–æ–≤

### External APIs
- **TON Blockchain** ‚Äî –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö –∏ –±–∞–ª–∞–Ω—Å–µ
- **CoinGecko API** ‚Äî –∞–∫—Ç—É–∞–ª—å–Ω—ã–π –∫—É—Ä—Å TON/USD –¥–ª—è —Ä–∞—Å—á–µ—Ç–æ–≤
- **TON Center API** ‚Äî —Ä–µ–∑–µ—Ä–≤–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö –æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö

### –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
- **Git** ‚Äî –∫–æ–Ω—Ç—Ä–æ–ª—å –≤–µ—Ä—Å–∏–π
- **ngrok / localtunnel** ‚Äî HTTPS —Ç—É–Ω–Ω–µ–ª–∏ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- **Postman / Insomnia** ‚Äî —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ REST API
- **Django Admin** ‚Äî –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

## Installation

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.10 –∏–ª–∏ –≤—ã—à–µ
- pip (–º–µ–Ω–µ–¥–∂–µ—Ä –ø–∞–∫–µ—Ç–æ–≤ Python)
- Git (–¥–ª—è –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è)

### –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**
   ```bash
   git clone https://github.com/Timatutu/pet-project-wallet-tax.git
   cd pet-project-wallet-tax/wallet
   ```

2. **–°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:**
   ```bash
   python -m venv venv
   ```

3. **–ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:**
   
   –ù–∞ macOS/Linux:
   ```bash
   source venv/bin/activate
   ```
   
   –ù–∞ Windows:
   ```bash
   venv\Scripts\activate
   ```

4. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
   ```bash
   pip install -r requirements.txt
   ```

5. **–ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:**
   ```bash
   python manage.py migrate
   ```

6. **–°–æ–∑–¥–∞–π—Ç–µ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏):**
   ```bash
   python manage.py createsuperuser
   ```
   –í–≤–µ–¥–∏—Ç–µ email –∏ –ø–∞—Ä–æ–ª—å –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ.

7. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**
   ```bash
   python manage.py runserver
   ```

8. **–û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ –∞–¥—Ä–µ—Å—É:**
   ```
   http://localhost:8000/
   ```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å TON Connect

–î–ª—è —Ä–∞–±–æ—Ç—ã TON Connect —Ç—Ä–µ–±—É–µ—Ç—Å—è HTTPS. –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ ngrok –∏–ª–∏ localtunnel –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `TONCONNECT_SETUP.md`.

## Screenshots

<!-- –î–æ–±–∞–≤—å—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –≥–ª–∞–≤–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∑–¥–µ—Å—å -->
<!-- –ü—Ä–∏–º–µ—Ä: -->
<!-- ![–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (Dashboard)](docs/screenshots/dashboard.png) -->
<!-- *–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –±–∞–ª–∞–Ω—Å–æ–º, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –∫–æ—à–µ–ª—å–∫–µ* -->

<!-- ![–°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π](docs/screenshots/transactions.png) -->
<!-- *–ò—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π —Å –≤–∏–∑—É–∞–ª—å–Ω—ã–º —Ä–∞–∑–ª–∏—á–∏–µ–º –≤—Ö–æ–¥—è—â–∏—Ö/–∏—Å—Ö–æ–¥—è—â–∏—Ö* -->

<!-- ![–°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–∞–ª–æ–≥–æ–≤](docs/screenshots/tax.png) -->
<!-- *–†–∞—Å—á–µ—Ç –Ω–∞–ª–æ–≥–æ–≤ –∑–∞ –º–µ—Å—è—Ü –∏ –ø–æ–º–µ—Å—è—á–Ω–∞—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å* -->

<!-- ![–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏](docs/screenshots/auth.png) -->
<!-- *–°—Ç—Ä–∞–Ω–∏—Ü–∞ –≤—Ö–æ–¥–∞ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å –ø—Ä–µ–º–∏—É–º –¥–∏–∑–∞–π–Ω–æ–º* -->

## ER-–¥–∏–∞–≥—Ä–∞–º–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

<!-- –î–æ–±–∞–≤—å—Ç–µ ER-–¥–∏–∞–≥—Ä–∞–º–º—É –∑–¥–µ—Å—å -->
<!-- –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å draw.io –∏–ª–∏ dbdiagram.io -->
<!-- –ü—Ä–∏–º–µ—Ä: ![ER-–¥–∏–∞–≥—Ä–∞–º–º–∞](docs/database/er-diagram.png) -->

### –û–ø–∏—Å–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π:

- **User** ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–∏—Å—Ç–µ–º—ã (email, –¥–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏, —Å–≤—è–∑—å —Å WalletSession)
- **WalletSession** ‚Äî —Å–µ—Å—Å–∏–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö –∫–æ—à–µ–ª—å–∫–æ–≤ (–∞–¥—Ä–µ—Å, —Ç–∏–ø, —Å—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è, –¥–∞—Ç—ã —Å–æ–∑–¥–∞–Ω–∏—è/–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è)
- **TransactionHistory** ‚Äî –∏—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (hash, —Å—É–º–º–∞, –∞–¥—Ä–µ—Å–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è/–ø–æ–ª—É—á–∞—Ç–µ–ª—è, –≤—Ä–µ–º—è, —Å—Ç–∞—Ç—É—Å)

**–°–≤—è–∑–∏:**
- User (1) ‚Üê‚Üí (1) WalletSession ‚Äî –æ–¥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç –æ–¥–Ω—É —Å–µ—Å—Å–∏—é –∫–æ—à–µ–ª—å–∫–∞
- TransactionHistory —Å–≤—è–∑–∞–Ω–∞ —Å WalletSession —á–µ—Ä–µ–∑ wallet_address (–º–Ω–æ–≥–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –Ω–∞ –æ–¥–∏–Ω –∫–æ—à–µ–ª–µ–∫)

## API Documentation

### –ë–∞–∑–æ–≤—ã–π URL
```
/api/
```

### –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

#### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
```http
POST /api/register/
Content-Type: application/json

{
  "email": "user@example.com",
  "password": "secure_password",
  "password_confirm": "secure_password"
}
```

**–û—Ç–≤–µ—Ç (201):**
```json
{
  "id": 1,
  "email": "user@example.com",
  "tokens": {
    "access": "eyJ0eXAiOiJKV1QiLCJhbGc...",
    "refresh": "eyJ0eXAiOiJKV1QiLCJhbGc..."
  }
}
```

#### –í—Ö–æ–¥
```http
POST /api/login/
Content-Type: application/json

{
  "email": "user@example.com",
  "password": "secure_password"
}
```

**–û—Ç–≤–µ—Ç (200):** –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

#### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
```http
POST /api/refresh/
Content-Type: application/json

{
  "refresh_token": "eyJ0eXAiOiJKV1QiLCJhbGc..."
}
```

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "tokens": {
    "access": "eyJ0eXAiOiJKV1QiLCJhbGc...",
    "refresh": "eyJ0eXAiOiJKV1QiLCJhbGc..."
  }
}
```

### –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –∫–æ—à–µ–ª—å–∫–∞

#### –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ—à–µ–ª—å–∫–µ
```http
GET /api/Wallet/
Authorization: Bearer <access_token>
```

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "session_key": "...",
  "wallet_address": "UQAbc123...",
  "wallet_type": "tonkeeper",
  "connected": true,
  "created_at": "2025-01-15T10:00:00Z",
  "updated_at": "2025-01-15T10:00:00Z"
}
```

#### –ü–æ–¥–∫–ª—é—á–∏—Ç—å –∫–æ—à–µ–ª–µ–∫
```http
POST /api/Wallet/
Authorization: Bearer <access_token>
Content-Type: application/json

{
  "wallet_address": "UQAbc123...",
  "wallet_type": "tonkeeper"
}
```

#### –ü–æ–ª—É—á–∏—Ç—å –±–∞–ª–∞–Ω—Å
```http
GET /api/wallet/balance/
Authorization: Bearer <access_token>
```

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "address": "UQAbc123...",
  "balance": 123.456789123,
  "is_active": true,
  "balance_ton": "123.456789123"
}
```

#### –ü–æ–ª—É—á–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
```http
GET /api/wallet/transactions/?refresh=true
Authorization: Bearer <access_token>
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `refresh` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) ‚Äî –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±–ª–æ–∫—á–µ–π–Ω–∞

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "transactions": [
    {
      "tx_hash": "abc123...",
      "timestamp": "2025-01-15T10:30:00Z",
      "amount": 0.1,
      "amount_ton": "0.100000000",
      "from_address": "UQAbc123...",
      "to_address": "UQDef456...",
      "status": "completed",
      "created_at": "2025-01-15T11:00:00Z"
    }
  ],
  "count": 50,
  "loaded_from_blockchain": 25,
  "saved_to_db": 25,
  "from_cache": false
}
```

### –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –Ω–∞–ª–æ–≥–æ–≤

#### –ù–∞–ª–æ–≥ –∑–∞ –º–µ—Å—è—Ü
```http
GET /api/tax/month/?year=2025&month=1
Authorization: Bearer <access_token>
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `year` ‚Äî –≥–æ–¥ (4 —Ü–∏—Ñ—Ä—ã)
- `month` ‚Äî –º–µ—Å—è—Ü (1-12)

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "year": 2025,
  "month": 1,
  "total_sent_ton": 100.5,
  "total_sent_usd": 502.5,
  "total_tax_ton": 1.005,
  "total_tax_usd": 5.025,
  "transactions_count": 10,
  "transactions": [...],
  "demo_deals": [...]
}
```

#### –ù–∞–ª–æ–≥ –ø–æ –≤—Å–µ–º –º–µ—Å—è—Ü–∞–º
```http
GET /api/tax/all/?start_year=2025&start_month=1
Authorization: Bearer <access_token>
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `start_year` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) ‚Äî –≥–æ–¥ –Ω–∞—á–∞–ª–∞ –ø–µ—Ä–∏–æ–¥–∞
- `start_month` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) ‚Äî –º–µ—Å—è—Ü –Ω–∞—á–∞–ª–∞ –ø–µ—Ä–∏–æ–¥–∞

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "monthly_taxes": [
    {
      "year": 2025,
      "month": 1,
      "total_sent_ton": 100.5,
      "total_sent_usd": 502.5,
      "total_tax_ton": 1.005,
      "total_tax_usd": 5.025,
      "transactions_count": 10
    }
  ],
  "count": 1
}
```

#### –ò—Ç–æ–≥–æ–≤—ã–π –Ω–∞–ª–æ–≥
```http
GET /api/tax/total/?start_year=2025&start_month=1
Authorization: Bearer <access_token>
```

**–û—Ç–≤–µ—Ç (200):**
```json
{
  "total_tax_ton": 5.0,
  "total_tax_usd": 25.0,
  "total_sent_ton": 500.0,
  "total_sent_usd": 2500.0,
  "total_transactions": 50,
  "ton_price_usd": 5.0,
  "monthly_taxes": [...],
  "period": {
    "start": "2025-01",
    "end": "2025-12"
  }
}
```

### Postman/Insomnia Collection

–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–æ–ª–ª–µ–∫—Ü–∏—è API –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Ñ–∞–π–ª–µ `docs/api/cryptotax-wallet-api.json`

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è —Å—Ö–µ–º–∞

<!-- –î–æ–±–∞–≤—å—Ç–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—É—é —Å—Ö–µ–º—É –∑–¥–µ—Å—å -->
<!-- –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å draw.io, Mermaid –∏–ª–∏ –¥—Ä—É–≥–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç -->
<!-- –ü—Ä–∏–º–µ—Ä: ![–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](docs/architecture/system-architecture.png) -->

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

1. **–ë—Ä–∞—É–∑–µ—Ä (Frontend)** ‚Äî SPA –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ JavaScript —Å hash-based —Ä–æ—É—Ç–∏–Ω–≥–æ–º
2. **Django Backend** ‚Äî REST API —Å–µ—Ä–≤–µ—Ä —Å JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π
3. **SQLite Database** ‚Äî –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∫–æ—à–µ–ª—å–∫–∏, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏)
4. **TON Blockchain** ‚Äî –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö –æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö –∏ –±–∞–ª–∞–Ω—Å–µ —á–µ—Ä–µ–∑ pytoniq
5. **CoinGecko API** ‚Äî –∫—É—Ä—Å –≤–∞–ª—é—Ç –¥–ª—è —Ä–∞—Å—á–µ—Ç–æ–≤ –Ω–∞–ª–æ–≥–æ–≤

### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–¥–∫–ª—é—á–∞–µ—Ç –∫–æ—à–µ–ª–µ–∫ —á–µ—Ä–µ–∑ TON Connect –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. Frontend –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç AJAX –∑–∞–ø—Ä–æ—Å—ã –∫ Django API —Å JWT —Ç–æ–∫–µ–Ω–∞–º–∏
3. Backend —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏–∑ –±–ª–æ–∫—á–µ–π–Ω–∞ TON (LiteClient, TON API, TON Center)
4. –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ª–æ–∫–∞–ª—å–Ω—É—é –ë–î –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
5. –†–∞—Å—á–µ—Ç –Ω–∞–ª–æ–≥–æ–≤ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –ø–æ –º–µ—Ç–æ–¥—É FIFO
6. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –Ω–∞ Frontend —á–µ—Ä–µ–∑ JSON API

## Docstrings

–í –ø—Ä–æ–µ–∫—Ç–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã docstrings –≤ –∫–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –∫–ª–∞—Å—Å—ã:

- **views.py** ‚Äî –≤—Å–µ API endpoints –∏–º–µ—é—Ç docstrings —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- **tax_calculator.py** ‚Äî —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞—Å—á–µ—Ç–∞ –Ω–∞–ª–æ–≥–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã
- **tonservice.py** ‚Äî —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Å –±–ª–æ–∫—á–µ–π–Ω–æ–º TON –∏–º–µ—é—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è

–ü—Ä–∏–º–µ—Ä docstring:
```python
def calculate_tax_for_month(wallet_address, year, month, ton_price_usd=None):
    """
    –†–∞—Å—á—ë—Ç –Ω–∞–ª–æ–≥–∞ –∑–∞ –º–µ—Å—è—Ü –ø–æ –ª–æ–≥–∏–∫–µ:
    - —Å—á–∏—Ç–∞–µ–º –ø–æ–∫—É–ø–∫–∏ –∏ –ø—Ä–æ–¥–∞–∂–∏ TON;
    - –¥–ª—è –∫–∞–∂–¥–æ–π –ø—Ä–æ–¥–∞–∂–∏ —Å—á–∏—Ç–∞–µ–º –ø—Ä–∏–±—ã–ª—å = —Å—É–º–º–∞ –ø—Ä–æ–¥–∞–∂–∏ - —Å—É–º–º–∞ –ø–æ–∫—É–ø–æ–∫ (FIFO),
      –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–¥ —ç—Ç—É –ø—Ä–æ–¥–∞–∂—É;
    - –µ—Å–ª–∏ –ø—Ä–∏–±—ã–ª—å > 0, –Ω–∞–ª–æ–≥ = 5% –æ—Ç –ø—Ä–∏–±—ã–ª–∏;
    - –µ—Å–ª–∏ –ø—Ä–æ–¥–∞–∂–∞ "–≤ –º–∏–Ω—É—Å" (–ø—Ä–∏–±—ã–ª—å <= 0), –Ω–∞–ª–æ–≥ –Ω–µ –±–µ—Ä—ë—Ç—Å—è.
    """
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
wallet/
‚îú‚îÄ‚îÄ wallet/                    # –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Django
‚îÇ   ‚îú‚îÄ‚îÄ settings.py           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ urls.py               # –ì–ª–∞–≤–Ω—ã–µ URL –º–∞—Ä—à—Ä—É—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ wsgi.py               # WSGI –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ wallet_nalog/            # –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ models.py             # –ú–æ–¥–µ–ª–∏ –ë–î (User, WalletSession, TransactionHistory)
‚îÇ   ‚îú‚îÄ‚îÄ views.py              # API endpoints
‚îÇ   ‚îú‚îÄ‚îÄ serializers.py        # DRF —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ urls.py               # URL –º–∞—Ä—à—Ä—É—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ tonservice.py         # –†–∞–±–æ—Ç–∞ —Å TON –±–ª–æ–∫—á–µ–π–Ω–æ–º
‚îÇ   ‚îú‚îÄ‚îÄ tax_calculator.py     # –õ–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ –Ω–∞–ª–æ–≥–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ authentication.py     # JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ middleware.py         # –ö–∞—Å—Ç–æ–º–Ω—ã–µ middleware
‚îÇ   ‚îú‚îÄ‚îÄ templates/            # HTML —à–∞–±–ª–æ–Ω—ã
‚îÇ   ‚îî‚îÄ‚îÄ static/               # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã (CSS, JS)
‚îú‚îÄ‚îÄ requirements.txt          # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ manage.py                # Django management script
‚îî‚îÄ‚îÄ README.md               # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- `FRONTEND_DEV_GUIDE.md` ‚Äî –ø–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
- `TONCONNECT_SETUP.md` ‚Äî –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ TON Connect –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- `PRESENTATION_TEXT.md` ‚Äî —Ç–µ–∫—Å—Ç –¥–ª—è –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞

## –õ–∏—Ü–µ–Ω–∑–∏—è

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –≤ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª—è—Ö.

## –ö–æ–Ω—Ç–∞–∫—Ç—ã

–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π —Å–æ–∑–¥–∞–π—Ç–µ issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞.
